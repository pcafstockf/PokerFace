<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/markdown/overview-dev.md
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Language" content="en" />
    <title>PokerFace &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>PokerFace <(◕___◕)></h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="downloads.html" title="Downloads"><span class="none"></span>Downloads</a></li>
    <li><a href="https://www.github.com/pcafstockf/PokerFace" class="externalLink" title="Source Code"><span class="none"></span>Source Code</a></li>
    <li><a href="benchmarks.html" title="Benchmarks"><span class="none"></span>Benchmarks</a></li>
    <li class="active"><a href="#"><span class="none"></span>Dev Guide</a></li>
    <li><a href="apidocs/index.html" title="Java Doc"><span class="none"></span>Java Doc</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://www.bytelightning.com/" title="Foo" class="builtBy"><img class="builtBy"  alt="Foo" src="powered-by.png"    /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<p>This document is just a quick, high level overview of the design, classes, and code for PokerFace.  If you are looking for specifics of a paticular class or method, please consult it&#x2019;s Javadoc.</p>
<p>PokerFace only deals with http/https protocols, and handles everything asynchrounously.  Because of that this document will drop the HttpAsync prefixes and suffixes commonly used in <tt>org.apache.http.*</tt>.</p>
<p>With all the request / response / consumer / producer combinations, it is important to keep these specific meanings straight in your head:</p>
<p><a name="RequestConsumer"></a><b>Request-Consumer</b>: Consumes an HttpRequest from a client / browser.</p>
<ul>

<li><a href="apidocs/com/bytelightning/opensource/pokerface/RequestForScriptConsumer.html">RequestForScriptConsumer</a>, <a href="apidocs/com/bytelightning/opensource/pokerface/RequestForTargetConsumer.html">RequestForTargetConsumer</a>, <a href="apidocs/com/bytelightning/opensource/pokerface/RequestForFileConsumer.html">RequestForFileConsumer</a></li>
</ul>
<p><b>Request-Producer</b>: Issues an HttpRequest to a remote system.</p>
<ul>

<li><a href="apidocs/com/bytelightning/opensource/pokerface/TargetRequestProducer.html">TargetRequestProducer</a></li>
</ul>
<p><b>Response-Consumer</b>: Reads the response back from a remote system.</p>
<ul>

<li><a href="apidocs/com/bytelightning/opensource/pokerface/TargetResponseConsumer.html">TargetResponseConsumer</a></li>
</ul>
<p><b>Response-Producer</b>: Sends an HttpResponse back to a client / browser.</p>
<ul>

<li><a href="apidocs/com/bytelightning/opensource/pokerface/ResponseProducer.html">ResponseProducer</a>, <a href="apidocs/com/bytelightning/opensource/pokerface/ScriptResponseProducer.html">ScriptResponseProducer</a></li>
</ul>
<div class="section">
<div class="section">
<h3><a name="TargetDescriptor_.28aka_Target.29"></a><a name="TargetDescriptor"></a>TargetDescriptor (aka Target)</h3>
<p>A <a href="apidocs/com/bytelightning/opensource/pokerface/TargetDescriptor.html">TargetDescriptor</a> is basically an <a class="externalLink" href="http://hc.apache.org/httpcomponents-core-4.3.x/httpcore/apidocs/org/apache/http/HttpHost.html">org.apache.http.HttpHost</a> descrbing a remote system which PokerFace proxys to, and which keeps track of some meta-info that allows us to optionally transform the request url from the client into a suitable request to the remote Target.</p></div>
<div class="section">
<h3><a name="RequestHandler"></a>RequestHandler</h3>
<p>The <a href="apidocs/com/bytelightning/opensource/pokerface/RequestHandler.html">RequestHandler</a> is a singleton dispatcher that analyzes all new request from the browser (which may not yet be fully received yet).  Because this object is the brains behind PokerFace, we will discuss it in more detail:</p>
<p>The <a href="apidocs/com/bytelightning/opensource/pokerface/RequestHandler.html#processRequest-org.apache.http.HttpRequest-org.apache.http.protocol.HttpContext-">RequestHandler.processRequest</a> method is called by the framework, and always returns a subclass instance of <a href="apidocs/com/bytelightning/opensource/pokerface/AbsClientRequestConsumer.html">AbsClientRequestConsumer</a> (see below).</p>
<p>The flow of the <tt>processRequest</tt> method is as follows:</p>
<ol style="list-style-type: decimal">

<li>Checks to see if there is a static file matching the request uri.</li>
<li>If there is a matching static file, a <a href="apidocs/com/bytelightning/opensource/pokerface/RequestForFileConsumer.html">RequestForFileConsumer</a> is returned.</li>
<li>Checks to see if any script endpoint matches the browser request.
<ul>

<li>Please see the &#x2018;inspectRequest()&#x2019; method in the <a class="externalLink" href="http://pcafstockf.github.io/PokerFace/EndpointTemplate.js.html">EndpointTemplate.js</a> file for further documentation.</li>
</ul>
</li>
<li>If the script wished to handle the request, a <a href="apidocs/com/bytelightning/opensource/pokerface/RequestForScriptConsumer.html">RequestForScriptConsumer</a> is returned.</li>
<li>The request (possibly modified by the script) is matched against configured proxy <a href="#TargetDescriptor">TargetDescriptor</a>s
<ul>

<li>If a configured <tt>TargetDescriptor</tt> is <b>not</b> found <b>and</b> the redirect request came from the script endpoint, then <b>IF</b> the <tt>dynamicHostMap</tt> option is set to true, a proxy <tt>TargetDescriptor</tt> will be created on the fly.</li>
</ul>
</li>
<li>The <tt>processRequest</tt> method then returns a <a href="apidocs/com/bytelightning/opensource/pokerface/RequestForTargetConsumer.html">RequestForTargetConsumer</a> to consume the request.
<ul>

<li>NOTE: The Target itself may be null at this point, and if so the <tt>RequestForTargetConsumer.getResult</tt> method will return a <a href="apidocs/com/bytelightning/opensource/pokerface/ResponseProducer.html">ResponseProducer</a> instance that will send a 404 response back to the client.</li>
</ul>
</li>
</ol>
<p>NOTE: All <a href="#RequestConsumer">Request-Consumer</a>&#x2019;s have a <a href="apidocs/com/bytelightning/opensource/pokerface/AbsClientRequestConsumer.html#getResult--">getResult</a> method that returns a <a href="apidocs/com/bytelightning/opensource/pokerface/ResponseProducer.html">ResponseProducer</a> instance which will in turn produces the response back to the client.  The framework will pass this <tt>ResponseProducer</tt> to the <a href="apidocs/com/bytelightning/opensource/pokerface/RequestHandler.html#handle-com.bytelightning.opensource.pokerface.ResponseProducer-org.apache.http.nio.protocol.HttpAsyncExchange-org.apache.http.protocol.HttpContext-">RequestHandler.handle</a> method.</p></div>
<div class="section">
<h3><a name="Building"></a>Building</h3>
<p>On a Mac:</p>

<div>
<div>
<pre class="source">export JAVA_HOME=&quot;`/usr/libexec/java_home -v '1.8*'`&quot;
mvn clean package site
</pre></div></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p class="pull-right">Copyright &copy;2015&#x2013;2019
Frank Stock.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
